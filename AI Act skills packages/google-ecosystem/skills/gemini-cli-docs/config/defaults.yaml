# Default Configuration Values for gemini-cli-docs Skill
# Adapted from claude-ecosystem docs-management skill
# Values can be overridden via environment variables (see config_registry.py)

# HTTP and Network Configuration
http:
  # Default timeout for HTTP requests (seconds)
  default_timeout: 30

  # Maximum timeout for long-running operations (seconds)
  max_timeout: 1800

  # Default number of retry attempts for transient failures
  default_max_retries: 3

  # Initial delay for exponential backoff (seconds)
  initial_retry_delay: 1.0

  # Backoff multiplier for exponential backoff
  backoff_factor: 2.0

  # Retryable HTTP status codes
  retryable_status_codes:
    - 429  # Too Many Requests (rate limit)
    - 500  # Internal Server Error
    - 502  # Bad Gateway
    - 503  # Service Unavailable
    - 504  # Gateway Timeout

  # User agent string for HTTP requests
  user_agent: "Gemini-Docs-Scraper/1.0 (Educational purposes)"

  # Timeout for HEAD requests (seconds)
  head_request_timeout: 10

  # Timeout for markdown URL requests (seconds)
  markdown_request_timeout: 30

# Scraping Configuration
scraping:
  # URL exclusion patterns (regex patterns to skip during scraping)
  # These URLs are extracted from sources but should not be scraped
  url_exclusions:
    # GitHub raw content - repository files like GEMINI.md, CONTRIBUTING.md
    # These are internal repo files, not public documentation
    - "raw\\.githubusercontent\\.com"
    - "github\\.com/.*/blob/"
    # Private or maintainer-only repositories
    - "maintainers-gemini-cli"

  # Delay between requests (seconds) - rate limiting
  rate_limit: 0.5

  # Delay between HEAD requests (seconds)
  header_rate_limit: 0.3

  # Legacy names (for backward compatibility)
  rate_limit_delay: 0.5
  header_rate_limit_delay: 0.3

  # Maximum parallel workers for URL processing
  # Reduced from 8 - only ~43 pages, no need for high parallelism
  max_workers: 4

  # Maximum parallel workers for multi-source scraping
  max_source_workers: 4

  # Default timeout for scraping operations (seconds)
  default_timeout: 300

  # Default timeout for source scraping operations
  sources_default_timeout: 300

  # Lock acquisition timeout (seconds)
  lock_timeout: 30.0

  # Index update lock timeout (seconds)
  index_lock_timeout: 60.0

  # Progress lock timeout (seconds)
  progress_lock_timeout: 30.0

  # Maximum content age in days (for filtering old content)
  max_content_age_days: 0  # 0 = no age filtering

  # Skip existing files by default
  skip_existing: true

  # Progress reporting intervals
  progress_interval: 30  # Report progress every N seconds
  progress_url_interval: 10  # Report progress every N URLs

# Index Management Configuration
index:
  # Chunk size for reading large YAML files (lines per chunk)
  chunk_size: 1000

  # Token estimate threshold - files smaller than this are loaded all at once
  token_estimate_threshold: 20000

  # Lock timeout for index operations (seconds)
  lock_timeout: 30.0

  # Lock retry delay (seconds)
  lock_retry_delay: 0.1

  # Lock retry backoff delay (seconds)
  lock_retry_backoff: 0.5

  # File operation retry delay (seconds)
  file_retry_delay: 0.2

  # Maximum retries for file operations
  file_max_retries: 5

# Path Configuration
paths:
  # Base directory for canonical documentation storage (relative to skill dir)
  base_dir: "canonical"

  # Index filename
  index_filename: "index.yaml"

  # Temporary directory (relative to project root when starting with .claude/)
  # Uses project-standard .claude/temp/ location (already gitignored)
  temp_dir: ".claude/temp"

  # Output directory mappings (domain -> output subdirectory)
  output_dirs: {}

# File System Configuration (deprecated - use paths section)
filesystem:
  default_base_dir: "canonical"
  default_index_filename: "index.yaml"

# Validation Configuration
validation:
  timeout: 60
  max_retries: 1

# Drift Detection Configuration
drift:
  max_workers: 5
  timeout: 300

# Subprocess Configuration
subprocess:
  default_timeout: 10
  quick_timeout: 5
  install_timeout: 300
  long_timeout: 600
  build_timeout: 600

# Performance Configuration
performance:
  parallel_enabled: true
  parallel_min_urls: 2

# Search and Relevance Configuration
search:
  # Default number of results to return from search queries
  # Use --limit flag to override, or --no-limit for all results
  default_limit: 25

  # Minimum relevance score threshold (null = no threshold)
  # Results below this score are filtered out
  # Use --min-score flag to override
  min_score_default: null

  # Domain priority weights for relevance ranking
  # Higher weights boost results from that domain
  # Single domain for Gemini CLI docs (vs multi-domain for Claude docs)
  domain_weights:
    geminicli.com: 10.0  # Gemini CLI docs (only domain)

  # Score boosting factors for different match types
  match_weights:
    keyword_exact: 3.0      # Exact keyword match in index
    title_match: 2.5        # Query term appears in title
    tag_match: 1.5          # Query matches a document tag
    category_match: 1.0     # Query matches document category

  # Fuzzy matching configuration
  fuzzy:
    enabled: true
    threshold: 0.8          # Minimum similarity score (0.0-1.0)

# Keyword Extraction Configuration
keyword_extraction:
  limits:
    max_file_tokens: 4
    max_heading_phrases: 10
    max_heading_keywords: 8
    max_body_keywords: 6
    max_total_keywords: 12

  # YAKE automatic keyword extraction configuration
  yake:
    language: 'en'
    max_ngram_size: 3
    dedup_threshold: 0.7
    top_keywords: 15
    min_text_length: 50

# File Pattern Configuration
files:
  markdown_extension: ".md"
  yaml_extension: ".yaml"
  json_extension: ".json"

# User Agent Configuration
user_agents:
  default: "Gemini-Docs-Scraper/1.0 (Educational purposes)"
  management: "Gemini-Docs-Management-Bot/1.0"
  scraper: "Gemini-Docs-Scraper/1.0 (Educational purposes)"

# Cache Configuration
cache:
  # Enable inverted index caching for O(1) keyword lookups
  inverted_index_enabled: true

  # Cache TTL in seconds (0 = no expiry)
  ttl: 0

  # Cache directory (relative to skill directory)
  # NOTE: Currently hardcoded in cache_manager.py as ".cache"
  directory: ".cache"

  # Maximum cache size in MB (0 = unlimited)
  max_size_mb: 0

# Logging Configuration
logging:
  # Log directory (relative to skill directory)
  directory: "logs"

  # Log retention in days (for cleanup script)
  retention_days: 30

  # Maximum diagnostic files to keep per script
  max_diagnostics_per_script: 10

  # Log levels: DEBUG, INFO, WARNING, ERROR
  default_level: "INFO"

  # Enable detailed diagnostics JSON output
  diagnostics_enabled: true

# Maintenance Configuration
maintenance:
  # Drift detection defaults
  drift:
    check_404s: true
    check_hashes: false  # Disabled by default (network-intensive)
    max_workers: 5

  # Cleanup defaults
  cleanup:
    clean_404s: false    # Require explicit opt-in
    clean_missing: false # Require explicit opt-in
    dry_run: true        # Default to preview mode

  # Stale document thresholds
  stale:
    # Days since last fetch to consider stale
    threshold_days: 90
    # Auto-remove stale docs
    auto_remove: false

# Section Extraction Configuration
extraction:
  # Include child sections when extracting a heading
  include_children: true

  # Maximum section depth to include
  max_depth: 3

  # Add provenance frontmatter to extracted sections
  add_provenance: true

# Environment Variable Override Prefix
# All values can be overridden by setting environment variables with prefix:
# GEMINI_DOCS_<SECTION>_<KEY>
# Example: GEMINI_DOCS_HTTP_DEFAULT_TIMEOUT=60
# Example: GEMINI_DOCS_SCRAPING_MAX_WORKERS=5
# Example: GEMINI_DOCS_SEARCH_DEFAULT_LIMIT=50
# Example: GEMINI_DOCS_CACHE_TTL=3600
